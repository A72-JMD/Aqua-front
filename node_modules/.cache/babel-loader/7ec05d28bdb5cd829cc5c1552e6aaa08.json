{"ast":null,"code":"var _jsxFileName = \"/Users/JMD/Developments/Projects/Fiji-Web/src/views/Tickets/TicketDashboard.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { Pie } from \"react-chartjs-2\";\nimport { CustomTooltips } from \"@coreui/coreui-plugin-chartjs-custom-tooltips\";\nimport { Card, CardBody, CardColumns, CardHeader } from \"reactstrap\";\nimport { Auth, API } from \"aws-amplify\";\nfunction TicketDashboard(props) {\n  const [apiResult, setApiResult] = useState({});\n  const [infiniteLoopStopper, toInfinity] = useState({}); //eslint-disable-line\n  var apiResults = {};\n  var graphdata = {};\n  const options = {\n    tooltips: {\n      enabled: false,\n      custom: CustomTooltips\n    },\n    maintainAspectRatio: false\n  };\n  useEffect(() => {\n    onLoad();\n  }, [infiniteLoopStopper]); //eslint-disable-line\n\n  const onLoad = async () => {\n    apiResults = await getData();\n    if (apiResults) {\n      setApiResult(apiResults);\n    }\n  };\n\n  // Pull out into a generic reusable function\n  const getData = async () => {\n    try {\n      let apiName = \"Fiji-Dev\";\n      let path = \"/tickets/dashboard\";\n      let myInit = {\n        headers: {\n          Authorization: \"Bearer \".concat((await Auth.currentSession()).getIdToken().getJwtToken())\n        }\n      };\n      var result = await API.get(apiName, path, myInit);\n    } catch (e) {\n      if (e.message === \"Request failed with status code 502\") {} else {\n        alert(JSON.stringify(e));\n        props.onLogout();\n      }\n    }\n    return result;\n  };\n  const formatGraphData = () => {\n    console.log(\"test\");\n    for (var proj in apiResult) {\n      var d = [];\n      var l = [];\n      var polar = {\n        datasets: [{\n          data: [],\n          backgroundColor: [\"#FF6384\", \"#4BC0C0\", \"#FFCE56\", \"#E7E9ED\", \"#36A2EB\"],\n          label: \"\" // for legend\n        }],\n        labels: []\n      };\n      Object.values(apiResult[proj][\"Counts\"]).map(a => d.push(a)); //eslint-disable-line\n      Object.keys(apiResult[proj][\"Counts\"]).map(a => l.push(a)); //eslint-disable-line\n\n      polar.datasets[0].data = d;\n      polar.labels = l;\n      polar.datasets[0].label = proj;\n      graphdata[apiResult[proj][\"projectKey\"]] = polar;\n    }\n    console.log(graphdata);\n  };\n  const StatGraphs = () => {\n    formatGraphData();\n    return /*#__PURE__*/React.createElement(CardColumns, {\n      className: \"cols-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, Object.keys(apiResult).map((p, i) => /*#__PURE__*/React.createElement(Card, {\n      key: apiResult[p][\"projectKey\"],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CardHeader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, \"Tickets by status: \", p), /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chart-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Pie, {\n      data: graphdata[apiResult[p][\"projectKey\"]],\n      options: options,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }\n    }))))));\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"animated fadeIn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(StatGraphs, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }));\n}\nexport default TicketDashboard;","map":{"version":3,"names":["React","useState","useEffect","Pie","CustomTooltips","Card","CardBody","CardColumns","CardHeader","Auth","API","TicketDashboard","props","apiResult","setApiResult","infiniteLoopStopper","toInfinity","apiResults","graphdata","options","tooltips","enabled","custom","maintainAspectRatio","onLoad","getData","apiName","path","myInit","headers","Authorization","concat","currentSession","getIdToken","getJwtToken","result","get","e","message","alert","JSON","stringify","onLogout","formatGraphData","console","log","proj","d","l","polar","datasets","data","backgroundColor","label","labels","Object","values","map","a","push","keys","StatGraphs","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","p","i","key"],"sources":["/Users/JMD/Developments/Projects/Fiji-Web/src/views/Tickets/TicketDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Pie } from \"react-chartjs-2\";\r\nimport { CustomTooltips } from \"@coreui/coreui-plugin-chartjs-custom-tooltips\";\r\n\r\nimport { Card, CardBody, CardColumns, CardHeader } from \"reactstrap\";\r\n\r\nimport { Auth, API } from \"aws-amplify\";\r\n\r\nfunction TicketDashboard(props) {\r\n  const [apiResult, setApiResult] = useState({});\r\n  const [infiniteLoopStopper, toInfinity] = useState({}); //eslint-disable-line\r\n  var apiResults = {};\r\n  var graphdata = {};\r\n\r\n  const options = {\r\n    tooltips: {\r\n      enabled: false,\r\n      custom: CustomTooltips\r\n    },\r\n    maintainAspectRatio: false\r\n  };\r\n\r\n  useEffect(() => {\r\n    onLoad();\r\n  }, [infiniteLoopStopper]); //eslint-disable-line\r\n\r\n  const onLoad = async () => {\r\n    apiResults = await getData();\r\n    if (apiResults) {\r\n      setApiResult(apiResults);\r\n    }\r\n  };\r\n\r\n  // Pull out into a generic reusable function\r\n  const getData = async () => {\r\n    try {\r\n      let apiName = \"Fiji-Dev\";\r\n      let path = \"/tickets/dashboard\";\r\n      let myInit = {\r\n        headers: {\r\n          Authorization: `Bearer ${(await Auth.currentSession())\r\n            .getIdToken()\r\n            .getJwtToken()}`\r\n        }\r\n      };\r\n      var result = await API.get(apiName, path, myInit);\r\n    } catch (e) {\r\n      if (e.message === \"Request failed with status code 502\") {\r\n      } else {\r\n        alert(JSON.stringify(e));\r\n        props.onLogout();\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  const formatGraphData = () => {\r\n    console.log(\"test\");\r\n\r\n    for (var proj in apiResult) {\r\n      var d = [];\r\n      var l = [];\r\n      var polar = {\r\n        datasets: [\r\n          {\r\n            data: [],\r\n            backgroundColor: [\r\n              \"#FF6384\",\r\n              \"#4BC0C0\",\r\n              \"#FFCE56\",\r\n              \"#E7E9ED\",\r\n              \"#36A2EB\"\r\n            ],\r\n            label: \"\" // for legend\r\n          }\r\n        ],\r\n        labels: []\r\n      };\r\n\r\n      Object.values(apiResult[proj][\"Counts\"]).map(a => d.push(a)); //eslint-disable-line\r\n      Object.keys(apiResult[proj][\"Counts\"]).map(a => l.push(a)); //eslint-disable-line\r\n\r\n      polar.datasets[0].data = d;\r\n      polar.labels = l;\r\n      polar.datasets[0].label = proj;\r\n\r\n      graphdata[apiResult[proj][\"projectKey\"]] = polar;\r\n    }\r\n\r\n    console.log(graphdata);\r\n  };\r\n  const StatGraphs = () => {\r\n    formatGraphData();\r\n    return (\r\n      <CardColumns className=\"cols-2\">\r\n        {Object.keys(apiResult).map((p, i) => (\r\n          <Card key={apiResult[p][\"projectKey\"]}>\r\n            <CardHeader>Tickets by status: {p}</CardHeader>\r\n            <CardBody>\r\n              <div className=\"chart-wrapper\">\r\n                <Pie\r\n                  data={graphdata[apiResult[p][\"projectKey\"]]}\r\n                  options={options}\r\n                />\r\n              </div>\r\n            </CardBody>\r\n          </Card>\r\n        ))}\r\n      </CardColumns>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"animated fadeIn\">\r\n      <StatGraphs />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TicketDashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}