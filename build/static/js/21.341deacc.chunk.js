(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[21],{1141:function(e,a,t){},1387:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return C}));var n=t(4),c=t.n(n),l=t(954),r=t(931),o=t(932),s=t(955),i=t(956),m=t(937),u=t(957),d=t(958),p=t(924),E=t(925),f=t(1388),h=t(959),g=t(915),b=t(982),y=t(63),w=t(1033),N=t.n(w);t(1141);function C(e){const[a,t]=Object(b.a)({email:"",password:"",confirmPassword:"",confirmationCode:"",mfaVerificationCode:""}),[w,C]=Object(n.useState)(null),[v,S]=Object(n.useState)(!1),[j,x]=Object(n.useState)(!1),[O,F]=Object(n.useState)(""),[k,T]=Object(n.useState)(""),[A,L]=Object(n.useState)(""),[D,J]=Object(n.useState)(""),[R,V]=Object(n.useState)(!1);async function M(e){e.preventDefault(),x(!0);try{console.log("==========check email=============="),console.log(a.email);const e=await y.b.signUp({username:a.email,password:a.password,attributes:{"custom:Group":"Customer"}});console.log("==========check newuser=============="),console.log(e),x(!1),C(e)}catch(t){alert(t.message),x(!1)}}async function P(e){e.preventDefault(),x(!0),await y.b.confirmSignUp(a.email,a.confirmationCode).then(e=>console.log(e));try{await(async()=>{var e=await y.b.signIn(a.email,a.password);J(e.username);var t={session:e.Session};try{let e="Fiji-Dev",a="/secretgenerator",c={headers:{"Content-Type":"application/json"},body:t};var n=await y.a.post(e,a,c);console.log(n)}catch(c){"Request failed with status code 502"===c.message||alert(JSON.stringify(c))}return n})().then(e=>{T(e.SecretCode),L(e.Session),F("otpauth://totp/Fiji:"+a.email+"?secret="+e.SecretCode+"&issuer=Fiji-issuer")}).catch(e=>console.log(e)),S(!0),x(!1)}catch(t){alert(t),x(!1)}}async function q(t){try{t.preventDefault(),x(!0),await(async e=>{var a={session:A,code:e,device:""};try{let e="Fiji-Dev",n="/finalise-mfa",c={headers:{"Content-Type":"application/json"},body:a};var t=await y.a.post(e,n,c)}catch(n){"Request failed with status code 502"===n.message||alert(JSON.stringify(n))}return t})(a.mfaVerificationCode)}catch(n){alert("Waiting for Reece to fix the Lambda :)"),alert(JSON.stringify(n.message))}e.history.push("/login"),x(!1)}return c.a.createElement("div",{className:"Register"},null===w?c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(r.a,{className:"justify-content-center"},c.a.createElement(o.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:M},c.a.createElement("h1",null,"Register"),c.a.createElement("p",{className:"text-muted"},"Create your account"),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"@")),c.a.createElement(E.a,{id:"email",type:"text",placeholder:"Email",autoComplete:"email",onChange:t,value:a.email})),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,c.a.createElement("i",{className:"icon-lock"}))),c.a.createElement(E.a,{id:"password",type:"password",placeholder:"Password",autoComplete:"new-password",onChange:t})),c.a.createElement(u.a,{className:"mb-4"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,c.a.createElement("i",{className:"icon-lock"}))),c.a.createElement(E.a,{id:"confirmPassword",type:"password",placeholder:"Confirm password",autoComplete:"new-password",onChange:t})),c.a.createElement(g.a,{color:"success",block:!0,isLoading:j,disabled:j}," ","Create Account"))),c.a.createElement(h.a,{className:"p-4"})))))):!1===v?c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(r.a,{className:"justify-content-center"},c.a.createElement(o.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:P},c.a.createElement("h1",null,"Confirmation code"),c.a.createElement("p",{className:"text-muted"},"Enter the code from your email to confirm."),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"#")),c.a.createElement(E.a,{id:"confirmationCode",type:"tel",placeholder:"Confirmation Code",onChange:t,autoFocus:!0,value:a.confirmationCode})),c.a.createElement(g.a,{color:"success",block:!0,isLoading:j,disabled:j}," ","Create Account"))),c.a.createElement(h.a,{className:"p-4"})))))):c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(r.a,{className:"justify-content-center"},c.a.createElement(o.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:q},c.a.createElement("h1",null,"Enable MFA"),c.a.createElement("p",{className:"text-muted"},"Enter the code from your email to confirm."),c.a.createElement(N.a,{value:O}),c.a.createElement("p",null,"Scan the code above in your Authenticator app of choice."),c.a.createElement("p",null,"If you are unable to scan the image, enter the following information:",c.a.createElement("br",null),"code: ",k),c.a.createElement("p",null,"Enter the value in the field below to verify the account."),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"#")),c.a.createElement(E.a,{id:"mfaVerificationCode",type:"tel",placeholder:"Verify MFA Code",onChange:t,autoFocus:!0})),c.a.createElement(g.a,{color:"success",block:!0,isLoading:j,disabled:j},"Verify Code"),c.a.createElement("p",null,c.a.createElement(f.a,{color:"danger",className:R?"alert-shown":"alert-hidden"},"Failed to verify MFA code.")))),c.a.createElement(h.a,{className:"p-4"})))))))}},915:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(4),c=t.n(n),l=t(917),r=t(1032);t(916);function o(e){let{isLoading:a,className:t="",disabled:n=!1,...o}=e;return c.a.createElement(l.a,Object.assign({className:"LoaderButton ".concat(t),disabled:n||a},o),a&&c.a.createElement(r.a,{size:"sm",color:"light"}),o.children)}},916:function(e,a,t){},982:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(4);function c(e){const[a,t]=Object(n.useState)(e);return[a,function(e){t({...a,[e.target.id]:e.target.value})}]}}}]);
//# sourceMappingURL=21.341deacc.chunk.js.map