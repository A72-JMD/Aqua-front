(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[24],{1402:function(e,t,a){"use strict";a.r(t);var n=a(4),l=a.n(n),c=a(931),o=a(932),r=a(955),s=a(944),i=a(956),u=a(959),m=a(1025),d=a(1021),p=a(1022),g=a(1023),f=a(917),y=a(63),h=a(19),k=a(929);t.default=function(e){let{id:t}=Object(h.m)();const[a,v]=Object(n.useState)(!1),[E,b]=Object(n.useState)({projectKey:"",projectName:"",priority:{id:"",name:""},issuetype:{id:"",name:""},statusId:"",statusName:"",summary:"",description:""}),[w,j]=Object(n.useState)(!1),[N,O]=Object(n.useState)(""),[T,S]=Object(n.useState)(""),[C,M]=Object(n.useState)([]),x=(e,t)=>{var a={...E,...t};b({...a})};var F={key:"ticketType",label:"Ticket Type",type:"select",options:{Task:"Task"},value:E.issuetype.name,onChange:x},I={key:"issueType",label:"Ticket Type",type:"select",options:{Task:"Task","New Feature":"New Feature",Improvement:"Improvement",Bug:"Bug",Epic:"Epic"},value:E.issuetype.name,onChange:x},B={key:"project",label:"Project",type:"static",value:{C1:"TestCustomerOne",FP:"Fortian Portal",VEN:"Vendor Assessment"}[T]},L=[{key:"priorityName",label:"Priority",type:"select",options:{Lowest:"Lowest",Low:"Low",Medium:"Medium",High:"High",Highest:"Highest"},value:E.priority.name,onChange:x},{key:"reporter",label:"Reporter",type:"static",value:e.userDetails.userInfo.email},{key:"summary",label:"Ticket Summary",props:{required:!0},value:E.summary,onChange:x},{key:"description",label:"Ticket Description",type:"textarea",props:{required:!0},value:E.description,onChange:x}];Object(n.useEffect)(()=>{(async()=>{await(async e=>{console.log("Getting jira ticket: "+e);let t="",a="/tickets/"+e,n={headers:{Authorization:"Bearer ".concat((await y.b.currentSession()).getIdToken().getJwtToken())}};try{t=await y.a.get("Fiji-Dev",a,n),b({...t.fields}),S(t.fields.project.key)}catch(l){alert(l)}return t})(t)})(),(()=>{var e=[];switch(T){case"C1":e=[B,F,...L];break;case"FP":I.value=E.issuetype.name,e=[B,I,...L];break;case"VEN":default:e=[B,F,...L]}M(e)})()},[T]);const q=async e=>{console.log("submitted"),v(!0);var a=await(async e=>{console.log("posting");let a="",n="/tickets/".concat(t,"/update"),l={headers:{Authorization:"Bearer ".concat((await y.b.currentSession()).getIdToken().getJwtToken()),"Content-Type":"application/x-www-form-urlencoded"},body:{body:e}};try{a=await y.a.post("Fiji-Dev",n,l)}catch(c){alert(c)}return a})(E);console.log(a),"None"===a.result&&P(!0),v(!1)},P=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];j(e)};return l.a.createElement("div",{className:"animated fadeIn"},l.a.createElement(l.a.Suspense,{fallback:l.a.createElement("div",{className:"animated fadeIn pt-3 text-center"},"Loading...")},l.a.createElement(c.a,null,l.a.createElement(o.a,{xs:"12"},l.a.createElement(r.a,null,l.a.createElement(s.a,null,"Update ticket: ",l.a.createElement("strong",null,t)),l.a.createElement(i.a,null,l.a.createElement(c.a,null,l.a.createElement(k.a,{className:"form",title:N,model:C,onSubmit:e=>{q()}}))),l.a.createElement(u.a,null)))),l.a.createElement(m.a,{isOpen:w,toggle:P,className:"modal-success"},l.a.createElement(d.a,{toggle:P},"Ticket updated"),l.a.createElement(p.a,null,"Ticket "," ".concat(t," ")," was successfully updated."),l.a.createElement(g.a,null,l.a.createElement(f.a,{color:"secondary",onClick:()=>{j(!1)}},"Ok")))))}},915:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),l=a.n(n),c=a(917),o=a(1032);a(916);function r(e){let{isLoading:t,className:a="",disabled:n=!1,...r}=e;return l.a.createElement(c.a,Object.assign({className:"LoaderButton ".concat(a),disabled:n||t},r),t&&l.a.createElement(o.a,{size:"sm",color:"light"}),r.children)}},916:function(e,t,a){},919:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a(63),l=a(55);async function c(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{console.log("Test Getting");let c=l.a.apiGateway.NAME,o=e,r=t?{headers:{Authorization:"Bearer ".concat((await n.b.currentSession()).getIdToken().getJwtToken())}}:"";var a=await n.a.get(c,o,r);console.log("GET result"),console.log(a)}catch(c){if("Request failed with status code 502"===c.message);else{if("Request failed with status code 400"===c.message)return null;console.log(c)}}return a}async function o(e,t){try{delete t.isLoading;let c=l.a.apiGateway.NAME,o=e,r={headers:{Authorization:"Bearer ".concat((await n.b.currentSession()).getIdToken().getJwtToken())},body:t};var a=await n.a.post(c,o,r);console.log("POST result"),console.log(a)}catch(c){"Request failed with status code 502"===c.message||(console.log("POST ERROR"),console.log(c))}return a}},929:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(4),l=a.n(n),c=a(973),o=a(925),r=a(974),s=a(975),i=a(976),u=a(977),m=a(932),d=a(955),p=a(937),g=a(944),f=a(956),y=a(959),h=a(917),k=a(915),v=a(919);function E(e){const[t,a]=Object(n.useState)({isLoading:!1,doneBuildingModel:!1,dependencies:{},formModel:{}}),[E,b]=Object(n.useState)(0),[w,j]=Object(n.useState)(0),[N,O]=Object(n.useState)(0),T=Object(n.useRef)(null);var S=[{}];Object(n.useEffect)(()=>{(async()=>{await C()})()},[]);const C=()=>{let n=e.model;var l={...t};console.log("JMD-"),b(e.visiblePage?e.visiblePage:0),j(e.maxPages?e.maxPages:1),l.formModel=n,l.doneBuildingModel=!0,a({...l})},M=async n=>{console.log("submitted"),n.preventDefault();let l=t.formModel,c={};l.map(e=>{e.options?c[e.key]=e.value||Object.keys(e.options)[0].toString():c[e.key]=e.value||""}),(()=>{var e=!0;try{Object.keys(t.formModel).map((function(a){console.log(S[a].required),S[a].required&&t.formModel[a].length<=0&&(e=!1),t.formModel[a].length>0&&t.formModel[a].length<S[a].length&&(e=!1)}))}catch(a){}return e})()?(a({...t,isLoading:!0}),e.onSubmit&&e.onSubmit(c),a({...t,isLoading:!1}),console.log("Validation Success")):alert("Validation Failed")},x=(e,n)=>{var l={...t},c=l.formModel.findIndex(t=>t.key===e);c>-1?l.formModel[c].value=n:console.log("Failed to find index in model"),a({...l})};function F(e){let a=t.formModel.findIndex(t=>t.key===e);return a>-1?t.formModel[a]:(console.log("findFieldByKey() failed to find index"),null)}const I=e=>{var a=e.target.name,n=e.target.value;x(a,n);var l=F(a);l.onChange&&l.onChange(e,t)},B=e=>{var a=e.target.name,n=e.target.value;x(a,n);var l=F(a);l.onChange&&l.onChange(e,t)},L=e=>{var n=e.target.name;((e,n,l)=>{var c={...t},o=c.formModel.findIndex(t=>t.key===e);if(o>-1){var r=[];""===c.formModel[o].value&&(c.formModel[o].value=r),r=c.formModel[o].value,l?r.push(n):r=r.filter(e=>e!==n),c.formModel[o].value=r}else console.log("Failed to find index in model");a({...c})})(n,e.target.value,e.target.checked);var l=F(n);l.onChange&&l.onChange(e,t)},q=async n=>{a({...t,isLoading:!0}),T.current=n.target.files[0];var l=n.target.attributes.order.value,c=T.current.name.split(".").pop(),o=n.target.id;if(T.current&&T.current.size>5e6)alert("Please pick a file smaller than ".concat(5," MB."));else{var r=await(async t=>Object(v.a)("/files/presignedurl?fileName=".concat(t,"&assessment=").concat(e.assessmentId)))("".concat(l,".").concat(c));try{await fetch(r.body,{method:"PUT",body:T.current,headers:{"Content-Type":"multipart/form-data"}}).then(e=>e.json())}catch(n){"Request failed with status code 502"===n.message||console.log(n)}var s={...t};x(o,T.current.name),a({...s}),e.onSubmit&&e.onSubmit(s),a({...t,isLoading:!1})}},P=e=>{e.preventDefault(),E+2>w?console.log("".concat(E+2," is greater than the max pages ").concat(w)):b(E+1)},D=(e,t)=>{e.preventDefault(),t+1>=N&&t+1<=w?b(t):console.log("".concat(t," is out of bounds."))},R=(e,t,a)=>!0===e?l.a.createElement(o.a,{className:"form-check-input",type:"radio",id:"".concat(t,"_").concat(a),questionId:t,name:t,value:a,parent:t,onChange:e=>{B(e)},checked:!0}):l.a.createElement(o.a,{className:"form-check-input",type:"radio",id:"".concat(t,"_").concat(a),questionId:t,name:t,value:a,parent:t,onChange:e=>{B(e)}}),V=(t,a,n)=>l.a.createElement("div",null,l.a.createElement(o.a,Object.assign({},e,{type:"select",id:a,name:a,key:"".concat(a,"input"),defaultValue:n,onChange:e=>{I(e)},required:!0,className:"form-control"}),Object.keys(t).map((e,a)=>l.a.createElement("option",{key:"".concat(a,"selectOption"),value:e,selected:t[e]===n?"selected":""},t[e])))),z=(t,a,n)=>l.a.createElement("div",null,l.a.createElement(o.a,Object.assign({},e,{type:t,id:a,name:a,key:"".concat(a,"input"),defaultValue:n,onChange:e=>{I(e)},required:!0,className:"form-control"}))),A=(t,a,n,c)=>!0===(""!==n)?(e=>l.a.createElement("p",{className:"form-control-static"},e))(n):l.a.createElement("div",null,l.a.createElement(o.a,Object.assign({},e,{type:t,id:a,name:a,key:"".concat(a,"input"),onChange:e=>{q(e)},order:c,"data-order":c,required:!0,className:"form-control"}))),J=e=>l.a.createElement(s.a,{listClassName:"justify-content-center"},l.a.createElement(i.a,{disabled:0===E},l.a.createElement(u.a,{previous:!0,onClick:e=>(e=>{e.preventDefault(),E-1<N?console.log("".concat(E-1," is less than the min pages ").concat(N)):b(E-1)})(e),href:"#"})),[...Array(e)].map((e,t)=>l.a.createElement(i.a,{active:t===E,key:t},l.a.createElement(u.a,{onClick:e=>D(e,t),href:"#"},t+1))),l.a.createElement(i.a,{disabled:E+1===e},l.a.createElement(u.a,{next:!0,onClick:e=>P(e),href:"#"}))),_=e=>{try{return l.a.createElement(l.a.Fragment,null,Object.keys(e[E]).map((a,n)=>l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,a),l.a.createElement("p",null),l.a.createElement("div",null,e[E][a].sort((e,t)=>e.order>t.order).map(n=>{let s=n.key,i=n.type||"text",u=(n.props,n.placeholder,n.value||""),d=n.options||{},p=n.question_ref;return(async e=>{e.map((t,a)=>{var n=e[a].key;S[n]={...e[a].validation}})})(e[E][a]),(e=>{var a={...t};e.map((e,t)=>{e.dependencies.length>0&&(a.dependencies[e.key]=e.dependencies)})})(e[E][a]),l.a.createElement(c.a,{row:!0,key:"".concat(s,"label")},l.a.createElement(m.a,{md:"3"},l.a.createElement(r.a,{htmlFor:s},n.order," - ",n.label)),l.a.createElement(m.a,{xs:"12",md:"9"},(()=>{switch(i){case"select":return V(d,s,u);case"radio":return function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return l.a.createElement("span",null,Object.keys(e).sort((e,t)=>e<t).map((a,o)=>l.a.createElement(c.a,{key:"".concat(o,"radioformgroup"),check:!0,className:"radio"},R(a===n,t,a),l.a.createElement(r.a,{check:!0,className:"form-check-label",htmlFor:"".concat(t,"_").concat(a)},e[a]))))}(d,s,p,u);case"checkbox":return function(e,a){var n=[],s=t.formModel.findIndex(e=>e.key===a);return s>-1?n=t.formModel[s].value:console.log("Failed to find index in model"),l.a.createElement("span",null,Object.keys(e).map((t,s)=>l.a.createElement(c.a,{check:!0,className:"checkbox",key:"".concat(s,"checkboxformgroup")},l.a.createElement(o.a,{className:"form-check-input",type:"checkbox",id:"".concat(a,"_").concat(t),name:a,value:t,parent:a,onChange:e=>{L(e)},checked:n.includes(t)}),l.a.createElement(r.a,{check:!0,className:"form-check-label",htmlFor:"".concat(a,"_").concat(t)},e[t]))))}(d,s,u);case"text":case"textarea":case"date":case"tel":return z(i,s,u);case"file":return A(i,s,u,n.order);default:return"renderStatic(fieldValue)"}})()))})))),J(w))}catch(a){return l.a.createElement("div",null,a.message)}};return l.a.createElement(m.a,{md:"12"},l.a.createElement(d.a,null,l.a.createElement(p.a,{className:"needs-validation",noValidate:!0,onSubmit:e=>{M(e)},method:"post"},(()=>{if(e.title)return l.a.createElement(g.a,null,l.a.createElement("strong",null,e.title))})(),l.a.createElement(f.a,null,!0===t.doneBuildingModel&&(()=>{let a=t.formModel;if(!0===e.pagination){var n=[...new Set(a.map(e=>e.category))].map(e=>{var t={};return t[e]=a.filter(t=>t.category===e),t});return _(n)}})()),l.a.createElement(y.a,null,l.a.createElement("div",null),l.a.createElement(k.a,{size:"sm",color:"primary",type:"submit",isLoading:t.isLoading,className:"mx-1"},"Save"),(()=>{if(e.cancelButton)return l.a.createElement(h.a,{size:"sm",color:"link",type:"reset",className:"mx-1",onClick:e.cancelButton},e.cancelButtonText)})()))))}}}]);
//# sourceMappingURL=24.c618010d.chunk.js.map