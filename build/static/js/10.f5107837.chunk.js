(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[10],{1150:function(e,a,t){},1153:function(e,a){},1155:function(e,a){},1164:function(e,a){},1166:function(e,a){},1194:function(e,a){},1196:function(e,a){},1197:function(e,a){},1202:function(e,a){},1204:function(e,a){},1210:function(e,a){},1212:function(e,a){},1231:function(e,a){},1243:function(e,a){},1246:function(e,a){},1389:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return x}));var n=t(4),c=t.n(n),l=t(954),o=t(931),r=t(932),s=t(955),i=t(956),m=t(937),u=t(957),d=t(958),p=t(924),f=t(925),E=t(1388),g=t(959),h=t(915),w=t(63),b=t(1033),y=t.n(b),N=(t(1150),t(983)),v=t.n(N),S=t(936),j=t(919),C=t(1151),O=t.n(C);function x(e){const[a,t]=Object(n.useState)({email:"",password:"",confirmPassword:"",confirmationCode:"",mfaVerificationCode:""}),[b,N]=Object(n.useState)(null),[C,x]=Object(n.useState)(!1),[T,k]=Object(n.useState)(!1),[F,A]=Object(n.useState)(""),[R,V]=Object(n.useState)(""),[L,I]=Object(n.useState)(""),[J,z]=Object(n.useState)(""),[M,q]=Object(n.useState)(!1),[D,G]=Object(n.useState)(!1),[P,B]=Object(n.useState)(!0),[U,W]=Object(n.useState)("");Object(n.useEffect)(()=>{H()},[]);const H=async()=>{let n=v.a.parse(e.location.search);if(n.jwt){var c="/jwtverify?jwt=".concat(n.jwt);if(null!==await Object(j.a)(c,!1)){var l=O.a.decode(n.jwt),o={...a};o.email=l.VendorEmail,t(o),W(l.VendorId),G(!0)}}else console.log("No JWT");B(!1)};async function K(e){e.preventDefault(),k(!0);try{const e=await w.b.signUp({username:a.email,password:a.password,attributes:{"custom:Group":"Vendor","custom:VendorId":U}});k(!1),N(e)}catch(t){alert(t.message),k(!1)}}const Q=e=>{var n={...a,[e.target.id]:e.target.value};t(n)};async function X(e){e.preventDefault(),k(!0),await w.b.confirmSignUp(a.email,a.confirmationCode).then(e=>console.log(e));try{await(async()=>{var e=await w.b.signIn(a.email,a.password);z(e.username);var t={session:e.Session};try{let e="Fiji-Dev",a="/signup/validate-mfa",c={headers:{"Content-Type":"application/json"},body:t};var n=await w.a.post(e,a,c)}catch(c){"Request failed with status code 502"===c.message||alert(JSON.stringify(c))}return n})().then(e=>{V(e.SecretCode),I(e.Session),A("otpauth://totp/Fortian:"+a.email+"?secret="+e.SecretCode+"&issuer=FortianMSS")}).catch(e=>console.log(e)),x(!0),k(!1)}catch(t){alert(t),k(!1)}}async function Y(t){t.preventDefault(),k(!0),await(async e=>{var a={session:L,code:e,device:""};try{let e="Fiji-Dev",n="/signup/finalise-mfa",c={headers:{"Content-Type":"application/json"},body:a};var t=await w.a.post(e,n,c)}catch(n){"Request failed with status code 502"===n.message||alert(JSON.stringify(n))}return t})(a.mfaVerificationCode),e.history.push("/login"),k(!1)}return c.a.createElement("div",{className:"Register"},P?c.a.createElement(S.a,null):D?null===b?c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(o.a,{className:"justify-content-center"},c.a.createElement(r.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:K},c.a.createElement("h1",null,"Register Vendor"),c.a.createElement("p",{className:"text-muted"},"Create vendor account"),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"@")),c.a.createElement(f.a,{id:"email",type:"text",placeholder:"Email",autoComplete:"email",onChange:Q,value:a.email})),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,c.a.createElement("i",{className:"icon-lock"}))),c.a.createElement(f.a,{id:"password",type:"password",placeholder:"Password",autoComplete:"new-password",onChange:Q})),c.a.createElement(u.a,{className:"mb-4"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,c.a.createElement("i",{className:"icon-lock"}))),c.a.createElement(f.a,{id:"confirmPassword",type:"password",placeholder:"Confirm password",autoComplete:"new-password",onChange:Q})),c.a.createElement(h.a,{color:"success",block:!0,isLoading:T,disabled:T}," ","Create Account"))),c.a.createElement(g.a,{className:"p-4"})))))):!1===C?c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(o.a,{className:"justify-content-center"},c.a.createElement(r.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:X},c.a.createElement("h1",null,"Confirmation code"),c.a.createElement("p",{className:"text-muted"},"Enter the code from your email to confirm."),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"#")),c.a.createElement(f.a,{id:"confirmationCode",type:"tel",placeholder:"Confirmation Code",onChange:Q,autoFocus:!0,value:a.confirmationCode})),c.a.createElement(h.a,{color:"success",block:!0,isLoading:T,disabled:T}," ","Create Account"))),c.a.createElement(g.a,{className:"p-4"})))))):c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(o.a,{className:"justify-content-center"},c.a.createElement(r.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement(m.a,{onSubmit:Y},c.a.createElement("h1",null,"Enable MFA"),c.a.createElement("p",{className:"text-muted"},"Enter the code from your email to confirm."),c.a.createElement(y.a,{value:F}),c.a.createElement("p",null,"Scan the code above in your Authenticator app of choice."),c.a.createElement("p",null,"If you are unable to scan the image, enter the following information:",c.a.createElement("br",null),"code: ",R),c.a.createElement("p",null,"Enter the value in the field below to verify the account."),c.a.createElement(u.a,{className:"mb-3"},c.a.createElement(d.a,{addonType:"prepend"},c.a.createElement(p.a,null,"#")),c.a.createElement(f.a,{id:"mfaVerificationCode",type:"tel",placeholder:"Verify MFA Code",onChange:Q,autoFocus:!0})),c.a.createElement(h.a,{color:"success",block:!0,isLoading:T,disabled:T},"Verify Code"),c.a.createElement("p",null,c.a.createElement(E.a,{color:"danger",className:M?"alert-shown":"alert-hidden"},"Failed to verify MFA code.")))),c.a.createElement(g.a,{className:"p-4"})))))):c.a.createElement("div",{className:"app flex-row align-items-center"},c.a.createElement(l.a,null,c.a.createElement(o.a,{className:"justify-content-center"},c.a.createElement(r.a,{md:"9",lg:"7",xl:"6"},c.a.createElement(s.a,{className:"mx-4"},c.a.createElement(i.a,{className:"p-4"},c.a.createElement("p",null,"To register as a vendor, please contact Fortian."))))))))}},915:function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));var n=t(4),c=t.n(n),l=t(917),o=t(1032);t(916);function r(e){let{isLoading:a,className:t="",disabled:n=!1,...r}=e;return c.a.createElement(l.a,Object.assign({className:"LoaderButton ".concat(t),disabled:n||a},r),a&&c.a.createElement(o.a,{size:"sm",color:"light"}),r.children)}},916:function(e,a,t){},919:function(e,a,t){"use strict";t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return o}));var n=t(63),c=t(55);async function l(e){let a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{console.log("Test Getting");let l=c.a.apiGateway.NAME,o=e,r=a?{headers:{Authorization:"Bearer ".concat((await n.b.currentSession()).getIdToken().getJwtToken())}}:"";var t=await n.a.get(l,o,r);console.log("GET result"),console.log(t)}catch(l){if("Request failed with status code 502"===l.message);else{if("Request failed with status code 400"===l.message)return null;console.log(l)}}return t}async function o(e,a){try{delete a.isLoading;let l=c.a.apiGateway.NAME,o=e,r={headers:{Authorization:"Bearer ".concat((await n.b.currentSession()).getIdToken().getJwtToken())},body:a};var t=await n.a.post(l,o,r);console.log("POST result"),console.log(t)}catch(l){"Request failed with status code 502"===l.message||(console.log("POST ERROR"),console.log(l))}return t}},936:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(4),c=t.n(n),l=t(1032);t(981);function o(e){let{isLoading:a,className:t="",disabled:n=!1,...o}=e;return c.a.createElement("div",{className:"animated fadeIn pt-3 pb-3 text-center"},c.a.createElement(l.a,{size:o.size?o.size:"sm",color:o.color?o.color:"dark",type:o.type?o.type:"grow"})," ","Loading...")}},981:function(e,a,t){}}]);
//# sourceMappingURL=10.f5107837.chunk.js.map